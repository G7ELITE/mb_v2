---
# Procedimentos - ManyBlack V2
# Define funis de procedimentos com passos e condições em PT-BR

- id: liberar_teste
  title: "Liberar acesso ao teste"
  description: "Procedimento para liberar acesso de teste do robô"
  steps:
    - name: "Concorda em depositar"
      condition: "o lead concordou em depositar ou já depositou"
      if_missing:
        automation: "ask_deposit_for_test"
    
    - name: "Criou conta"
      condition: "tem conta em alguma corretora suportada"
      if_missing:
        automation: "signup_link"
    
    - name: "Depósito confirmado"
      condition: "depósito confirmado"
      if_missing:
        automation: "prompt_deposit"
    
    - name: "Liberar"
      condition: "todas as etapas anteriores cumpridas"
      do:
        automation: "trial_unlock"

- id: onboarding_completo
  title: "Onboarding completo"
  description: "Procedimento de onboarding completo para novos leads"
  steps:
    - name: "Explicar robô"
      condition: "robô foi explicado para o lead"
      if_missing:
        automation: "explain_robot"
    
    - name: "Definir corretora"
      condition: "lead tem corretora definida"
      if_missing:
        automation: "ask_broker_preference"
    
    - name: "Conta criada"
      condition: "tem conta na corretora escolhida"
      if_missing:
        automation: "signup_link"
    
    - name: "Quer testar"
      condition: "manifestou interesse em testar"
      if_missing:
        automation: "explain_robot"
    
    - name: "Procedimento de teste"
      condition: "false"  # Sempre executa se chegou até aqui
      do:
        procedure: "liberar_teste"

- id: ajuda_deposito
  title: "Ajuda com depósito"  
  description: "Procedimento para ajudar com processo de depósito"
  steps:
    - name: "Tem conta"
      condition: "tem conta em alguma corretora"
      if_missing:
        automation: "signup_link"
    
    - name: "Orientação detalhada"
      condition: "false"  # Sempre executa
      do:
        automation: "deposit_help_detailed"

- id: reativacao_lead
  title: "Reativação de lead"
  description: "Procedimento para reativar leads inativos"
  steps:
    - name: "Verificar status"
      condition: "lead tem histórico de atividade"
      if_missing:
        automation: "explain_robot"
    
    - name: "Verificar conta"
      condition: "ainda tem conta ativa"
      if_missing:
        automation: "ask_broker_preference"
    
    - name: "Oferecer benefício"
      condition: "false"  # Sempre executa
      do:
        automation: "trial_unlock"

- id: suporte_tecnico
  title: "Suporte técnico"
  description: "Procedimento para questões técnicas"
  steps:
    - name: "Identificar problema"
      condition: "problema foi identificado"
      if_missing:
        automation: "ask_problem_details"
    
    - name: "Solução básica"
      condition: "false"  # Sempre executa
      do:
        automation: "provide_basic_solution"

# Metadados dos procedimentos
metadata:
  version: "1.0"
  last_updated: "2024-01-15"
  default_timeout: "5m"
  max_retries: 3
  
# Configurações globais
settings:
  # Tempo máximo para um procedimento completo
  max_procedure_time: "30m"
  
  # Cooldown entre execuções do mesmo procedimento
  procedure_cooldown: "1h"
  
  # Se deve logar cada passo
  log_steps: true
  
  # Se deve permitir procedimentos aninhados
  allow_nested_procedures: true

